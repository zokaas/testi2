"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getInstalledEslintVersion = getInstalledEslintVersion;
const devkit_1 = require("@nx/devkit");
const semver_1 = require("@nx/devkit/src/utils/semver");
const devkit_internals_1 = require("nx/src/devkit-internals");
function getInstalledEslintVersion(tree) {
    try {
        const eslintPackageJson = (0, devkit_internals_1.readModulePackageJson)('eslint').packageJson;
        return eslintPackageJson.version;
    }
    catch { }
    // eslint is not installed on disk, it could be in the package.json
    // but waiting to be installed
    const rootPackageJson = tree
        ? (0, devkit_1.readJson)(tree, 'package.json')
        : (0, devkit_1.readJsonFile)('package.json');
    const eslintVersionInRootPackageJson = rootPackageJson.devDependencies?.['eslint'] ??
        rootPackageJson.dependencies?.['eslint'];
    if (!eslintVersionInRootPackageJson) {
        // eslint is not installed
        return null;
    }
    try {
        // try to parse and return the version
        return (0, semver_1.checkAndCleanWithSemver)('eslint', eslintVersionInRootPackageJson);
    }
    catch { }
    // we could not resolve the version
    return null;
}
