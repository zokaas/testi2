"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getProjectPackageManagerWorkspaceState = getProjectPackageManagerWorkspaceState;
exports.isUsingPackageManagerWorkspaces = isUsingPackageManagerWorkspaces;
const devkit_1 = require("@nx/devkit");
const minimatch_1 = require("minimatch");
const posix_1 = require("node:path/posix");
const package_json_1 = require("nx/src/plugins/package-json");
function getProjectPackageManagerWorkspaceState(tree, projectRoot) {
    if (!isUsingPackageManagerWorkspaces(tree)) {
        return 'no-workspaces';
    }
    const patterns = (0, package_json_1.getGlobPatternsFromPackageManagerWorkspaces)(tree.root, (path) => (0, devkit_1.readJson)(tree, path, { expectComments: true }));
    const isIncluded = patterns.some((p) => (0, minimatch_1.minimatch)((0, posix_1.join)(projectRoot, 'package.json'), p));
    return isIncluded ? 'included' : 'excluded';
}
function isUsingPackageManagerWorkspaces(tree) {
    return (0, devkit_1.isWorkspacesEnabled)((0, devkit_1.detectPackageManager)(tree.root), tree.root);
}
